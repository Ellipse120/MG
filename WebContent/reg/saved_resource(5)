M.add("w-autocomplete",function(e){var t=e.Node,n=e.io,i=e.UA.ie,a=6===i,o=e.Lang.isArray,s=e.Lang.trim,r=e.mt.widget.util,u=e.mt.util,l={select:"AutoComplete.select",hide:"AutoComplete.hide",update:"AutoComplete.updateData",updateComplete:"AutoComplete.updateComplete",beforeShowResultBox:"beforeShowResultBox",beforeBuildCheckbox:"beforeBuildCheckbox",afterShowResultBox:"afterShowResultBox",afterBuildCheckbox:"afterBuildCheckbox",getMatchList:"getMatchList",beforeUpdateData:"beforeUpdateData",getObjListSuccess:"afterGetDataSuccess",dataInitSuccess:"dataInitSuccess",beforeShow:"beforeShow"},c={cssCompleteList:"widget-autocomplete-complete-list",cssTip:"widget-autocomplete-tip",cssList:"widget-autocomplete-list",cssMore:"widget-autocomplete-more",cssIE6BugFixed:"widget-autocomplete-ie6bugfix",cssLoading:"widget-autocomplete-loading",cssMenuOperator:"widget-autocomplete-menu-operator",cssScrollList:"widget-autocomplete-list--scroll"};e.namespace("mt.widget");var h=e.Base.create("Autocomplete",e.Widget,[e.WidgetPosition,e.WidgetPositionAlign,e.WidgetStack,e.mt.extension.List],{initializer:function(){var t=this;this.onceAfter("initializedChange",function(){t.bBox=t.get("boundingBox"),t.cBox=t.get("contentBox");var n=t.get("node");t.allNode=n instanceof e.NodeList?n:e.all(n),t.node=t.allNode.item(0),t.ndDoc=t.get("ndDoc"),t._ndListTrigger=t.node,t.checkedItemIds={},t.checkboxChanged={},t.preLen=0,t.timer=null,t.isLoading=!1,t.listCache={},t._handle={nodeEvent:null},t.on(l.dataInitSuccess,t.render),t._dataInit(),t.oldSelect=t.getValue()})},_dataInit:function(){this.addAyncSearchPlugin(),this.addCascadePlugin(),this._configAttr(),this._beforeRender()},_beforeRender:function(){var t=this.get("dataUrl"),n=this;t?e.mt.io.get(t,null,function(e){n.fire(l.getObjListSuccess,{res:e}),e.data&&n.set("objList",e.data),n.fire(l.dataInitSuccess,{objList:e.data})},null,!0):this.fire(l.dataInitSuccess)},addCascadePlugin:function(){var t=this.get("cascade");if(t){if(t.nds&&o(t.nds)&&this.set("node",t.nds[0]),t.actions&&o(t.actions)){var n=t.actions[0];(null!==n||""!==n)&&this.set("dataUrl",n)}this.plug(e.mt.plugin.autocomplete.Cascade,t)}},addAyncSearchPlugin:function(){var t=this.get("ayncsearch");t&&this.plug(e.mt.plugin.autocomplete.AyncSearch,{ayncsearch:t})},_configAttr:function(){this.node.get("id")||this.node.set("id",e.guid()),this.node.getAttribute("autocomplete")||this.node.setAttribute("autocomplete","off");var t=this.get("listParam");""===this.get("searchKey")&&this.set("searchKey",t),this._setPolling(this.get("searchKey"))},_setPolling:function(t){var n=this.get("polling");e.Lang.isArray(n)&&(0!==n.length&&e.mt.lang.inArray(t,n)||n.push(t),this.set("polling",n))},_updataObjList:function(t){var n=this.get("objList"),i=this.get("searchKey");"searchKey"===t.attrName?this._setPolling(i):"objList"===t.attrName&&(this.listCache={}),e.mt.pinyin.objListToPinyin(n,i)},setWidth:function(){var e=this.node.getStyle("width"),t=this.get("width");e="auto"!==e?parseInt(e.replace("px",""),10)+8:t;var n=2,i=this.node.get("offsetWidth")-n||e;142===t&&this.set("width",i)},renderUI:function(){this.after("searchKeyChange",function(e){this._updataObjList(e)}),this.after("objListChange",function(e){this._updataObjList(e)}),this.after("nodeChange",function(){this._bindQueryNodeHandler()}),this.after("menuItemChange",function(e){this._addMenuItem(e.newVal)}),e.mt.pinyin.objListToPinyin(this.get("objList"),this.get("searchKey"));var n=this.get("id"),i=this.get("menuItem");n&&this.bBox.setAttribute("id",n),this.setWidth(),a&&(this.ndIframe=t.create(e.Lang.sub(h.TEMPLATE.iframe,c)),this.bBox.appendChild(this.ndIframe));var o=this.get("listTemplate"),s=e.Lang.sub(o,e.mix({more:this.get("more"),msg:this.get("msg")},c)),r=t.create(s);this.cBox.appendChild(r),i&&i.length>0&&this._addMenuItem(i),this.ndUl=r.one("ul"),this.ndUl||(this.ndUl=this.cBox.one("ul")),this.ndMore=this._getOperatorNode().more},bindUI:function(){var t=this;this.get("placeholder")&&this.node.plug(e.mt.plugin.Placeholder),this._bindQueryNodeHandler(),this.get("showCheckbox")&&this._initCheckboxHandler(),e.Global.on(l.update,function(e){e.id===t.node.get("id")&&t.updateData(e)})},setValue:function(e){this.fillTargetInput(e)},getHiddenInput:function(){return this.node.get("parentNode").one('input[type="hidden"]')},getValue:function(){var e={};e.name=s(this.node.get("value"));var t=this.getHiddenInput();return t&&(e.id=s(t.get("value"))),e.hiddenInput=t,e},clearValue:function(){this.node.set("value","");var e=this.getHiddenInput();e&&e.set("value","")},_initCheckboxHandler:function(){var e=this;this.set("menuItem",[{title:"确定",callback:function(){e._resetCheckboxChanged(!0),e.getCheckedNodes(),e.hide()}}])},_getOperatorNode:function(){return{menuOperator:this.bBox.one("."+c.cssMenuOperator),more:this.bBox.one("."+c.cssMore)}},_bindQueryNodeHandler:function(){function t(t){n.node!==this?(n.hide(),n.node=this,n._ndListTrigger=n.node,n.node.get("id")||n.node.set("id",e.guid()),n.oldSelect=n.getValue(),t.halt(),n.show()):"none"===n.bBox.getStyle("display")&&(t.halt(),n.show())}var n=this;this._handle.nodeEvent=this.allNode.each(function(e){e.purge(),e.on({click:t,focus:t}),e.once({keydown:t})})},_addMenuItem:function(e){var n,i=this._getOperatorNode().menuOperator;i.set("text","");for(var a=0,o=e.length;o>a;++a)n=t.create('<li class="btn btn-block btn-primary">'+e[a].title+"</li>"),this._handle.menuItem=n.on("click",e[a].callback),i.appendChild(n)},modifyData:function(e){this.set("objList",e)},setOldSelect:function(e,t){this.oldSelect={},this.oldSelect.id=e,this.oldSelect[this.get("listParam")]=t},resetOldSelectValue:function(){this.oldSelect={}},_leave:function(){this.get("showCheckbox")?(this._resetCheckboxChanged(),this.getCheckedNodes()):this._selectUnique(),this.hide()},getCheckedNodes:function(){var e=[],t=this.checkedItemIds;for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];i.checked&&e.push(i)}return this.get("fillTarget")&&e.length>0&&this.fillTargetInput(e),this.resetOldSelectValue(),e},fillTargetInput:function(t){var n=[],i=[],a=this.getHiddenInput();if(e.Lang.isArray(t))for(var o=t.length,s=0;o>s;s++){var r=t[s].id,u=t[s].name;n.push(u),i.push(r),this.checkedItemIds["checked-"+r]={id:r,name:u,checked:!0}}else n[0]=t[this.get("listParam")],i[0]=t.id;this.get("showCheckbox")&&this.get("rememberable")&&this.setOldSelect(i.join(","),n.join(",")),this.node.set("value",n.join(",")),a&&a.set("value",i.join(","))},_getQueryParam:function(){var e={},t=this.get("queryNode");if(t)for(var n,i=0;i<t.length;i++)n=t[i],n&&(e[n.get("name")]=n.get("value"));return e},updateData:function(t,i){function a(t,n){e.Lang.isObject(t)||(t=[]),this.fire(l.beforeUpdateData,{objList:t,res:n}),this.get("defaultItem")&&o(t)&&t.unshift(this.get("defaultItem")),this.set("objList",t),s.bBox&&"block"===s.bBox.getStyle("display")&&this.displayList(),e.Global.fire(l.updateComplete,{})}var s=this;if(i||(this.clearValue(),this.resetOldSelectValue()),t.data)a.call(this,t.data);else if(t.action){this.async&&this.async.isInProgress()&&this.async.abort(),this.isLoading=!0;var r=this._getQueryParam();e.mix(r,{q:this.node.get("value")},!0),this.async=n(t.action,{method:"GET",data:r,on:{success:function(t,n){s.isLoading=!1;var i=u.getEvalRes(n);i.status?a.call(s,i.data,i):e.config.win.alert(i.msg)},failure:function(e,t){t.statusText&&"abort"===t.statusText||(s.isLoading=!1,s.cBox.setHTML("网络超时，请重试"))}}})}},show:function(){this.get("forbidWrite")&&this.clearValue(),this._showList(),this.valueChangeHandler&&this.valueChangeHandler.detach(),this.valueChangeHandler=this.node.on("valueChange",this._inputValueChange,this)},_inputValueChange:function(e){var t,n=e.newVal,i=this.get("searchInterval"),a=this;e._event&&13===e._event.keyCode||(n.trim().length>0?(t=function(){a.get("action")?a.updateData({action:a.get("action")},!0):a._showList()},i?(clearTimeout(this.timer),this.timer=setTimeout(t,i)):t()):clearTimeout(this.timer))},_showList:function(){var e={show:!0};this.fire(l.beforeShow,e),e.show&&this.displayList()},resetList:function(){this.ndUl.get("children").remove(),this.ndMore&&this.ndMore.setStyle("display","none")},displayList:function(){var n,i,a,s=this.getQueryString(),r=this.get("noDataTips"),u=this.get("objList"),d=[],g=this.get("contentBox");a=this.get("maxShowItemCount")?this.get("maxShowItemCount"):0,this.resetList(),this.fire(l.beforeShowResultBox,{objList:u||[]}),o(u)&&0===u.length&&this.get("defaultItem")&&u.unshift(this.get("defaultItem")),this.isLoading?(n=t.create(e.Lang.sub(h.TEMPLATE.loading,c)),d.push(n)):e.Object.isEmpty(u)?""!==r&&(n=t.create("<li>"+r+"</li>"),d.push(n)):d=this.getMatchList(s),i=new e.NodeList(d),i.size()>a?g.one("."+c.cssCompleteList).addClass(c.cssScrollList):g.one("."+c.cssCompleteList).removeClass(c.cssScrollList),this.fire(l.getMatchList,{matchList:i}),this.get("showCheckbox")&&(this.fire(l.beforeBuildCheckbox,{matchList:i,checkItems:this.checkedItemIds}),this._buildCheckboxNode(i),this.fire(l.afterBuildCheckbox,{matchList:i,checkItems:this.checkedItemIds})),this.ndUl.appendChild(i.toFrag()),this.showResultBox(),this.fire(l.afterShowResultBox,{ulBox:this.ndUl}),this.ndIframe&&this.resizeIframe()},_buildCheckboxNode:function(n){var i=this;n.each(function(n){var a=n.getData("objData");if(a){var o=n.getData("objData").id,s="";i.checkedItemIds["checked-"+o]&&i.checkedItemIds["checked-"+o].checked&&(s='checked="checked"');var r=t.create(e.Lang.sub(h.TEMPLATE.checkbox,{checked:s})),u=n.one('input[type="checkbox"]');u?s?u.setAttribute("checked","checked"):u.removeAttribute("checked"):(r.append(n.getHTML()),n.setHTML(r))}})},getQueryString:function(){var e=s(this.node.get("value")),t=this.get("toLowerCase");return t?e.toLowerCase():e},getMatchList:function(e){function t(e){var t=n.listCache[e];return t.showMax&&n.ndMore&&n.ndMore.setStyle("display","block"),t.matchList}var n=this;return""===e&&this.listCache.noData?t("noData"):this.listCache[e]?t(e):this.buildList()},buildList:function(){var n,i,a,o,s,r=0,u=!1,l=[],c=this.getQueryString(),h=this.get("itemTemplate"),d=this.get("highlightFirstMatch"),g=this.get("objList"),f=this.get("listParam");for(n in g)if(g.hasOwnProperty(n)){if(i=g[n],a=i[f],this.isMatchModeReg(i,c)&&(s=e.Lang.sub(h,e.merge(i,{text:a,className:0===r&&d?"current":""})),o=t.create(s),o.setData("objData",i),l.push(o),r++),this.get("maxShowItemCount"))continue;if(r>=this.get("showMax")){this.ndMore&&this.ndMore.setStyle("display","block"),u=!0;break}}var p={showMax:u,matchList:l};return""===c?this.listCache.noData=p:this.listCache[c]=p,l},isMatchModeReg:function(e,t){var n=this.get("matchMode"),i=this.get("polling"),a=r.getRegByMode(t,n),o=e.PY_ALL||"",u=e.PY_SHORT||"";if("none"===n)return!0;if(""===t||a.test(o)||a.test(u))return!0;for(var l=i.length,c=0;l>c;c++){var h=s(e[i[c]]);if(!h)break;if(this.get("toLowerCase")&&(h=e[i[c]].toLowerCase()),a.test(h))return!0}return!1},showResultBox:function(){this.bBox.setStyles({display:"block",position:"absolute"}),this.set("align",{node:this.node,points:["tl","bl"]})},_select:function(e){this.get("showCheckbox")||"INPUT"===e.get("nodeName")?this._changeCheckcboxState(e):this.selectHandler(e)},_changeCheckcboxState:function(e){var t="LI"===e.get("nodeName")?e:e.ancestor("li");if(!t.ancestor("."+c.cssMenuOperator)){var n=t.getData("objData");n&&(this._markCheckboxChanged("checked-"+n.id,t.one("input")),this.checkedItemIds["checked-"+n.id]={checked:t.one("input").get("checked"),id:n.id,name:n[this.get("listParam")]})}},_markCheckboxChanged:function(e,t){e in this.checkboxChanged?delete this.checkboxChanged[e]:this.checkboxChanged[e]=t},_resetCheckboxChanged:function(e){if(e)return void(this.checkboxChanged={});for(var t in this.checkboxChanged)this.checkboxChanged.hasOwnProperty(t)&&(this.checkedItemIds[t].checked=!this.checkedItemIds[t].checked,this.checkboxChanged[t].set("checked",this.checkedItemIds[t].checked));this.checkboxChanged={}},selectHandler:function(e){var t=e.getData("objData");if(t&&e&&e.get("text")!==this.get("noDataTips")){var n=t.id,i=t[this.get("listParam")];this.fillTargetInput(t),this.hide(),i!==this.oldSelect[this.get("listParam")]&&(this.setOldSelect(n,i),this.preLen=i.length),this.fire(l.select,{item:e,ins:this}),this.node.fire("widgetvaluechange",{item:e,data:e.getData("objData"),ins:this}),this.callback(t),this.redirectPage(n)}},redirectPage:function(e){var t=this.get("url");if(t&&""!==t){var n=/&/.test(t)?t+"&id="+e:t+"?id="+e;window.location.href=n}},callback:function(t){var n=this.get("cascade"),i=this.get("callback");!i&&n&&n.callback&&(i=n.callback[0]),i&&i(t,this.node),e.Global.fire(l.select,{id:this.node.get("id"),data:t})},hide:function(){""===this.node.get("value")&&(this.get("rememberable")===!0?this.setValue(this.oldSelect):this.clearValue()),this.node.blur(),this.bBox.setStyle("display","none"),this.timer&&window.clearInterval(this.timer),this.get("showCheckbox")&&this.bBox.all(".checkbox").each(function(){this.set("checked",!1)}),this.fire(l.hide,{id:this.node.get("id")})},_selectUnique:function(){var e=this.node.get("value");if(""!==e){var t=this.getQueryString(),n=this.getMatchList(t);1===n.length&&this._select(n[0])}},resizeIframe:function(){this.ndIframe.setStyle("width",parseInt(this.ndUl.getComputedStyle("width"),10)+2+"px"),this.ndIframe.setStyle("height",parseInt(this.ndUl.getComputedStyle("height"),10)+2+"px")},destructor:function(){u.detachHandle(this._handle)},_setNode:function(t){return this.node=e.one(t),this._ndListTrigger=this.node,this.node&&(this.oldSelect=this.getValue()),this.allNode=t instanceof e.NodeList?t:e.all(t),t}},{CSS_PREFIX:"widget-autocomplete",EVENT_NAME:l,CSS_NAME:c,TEMPLATE:{checkbox:'<label><input type="checkbox" name="widgetCheckbox" {checked} value=""/></label>',loading:'<p class="{cssLoading}"></p>',iframe:'<iframe class="{cssIE6BugFixed}" border="0"></iframe>'},ATTRS:{ndDoc:{value:e.one(e.config.doc)},msg:{value:"中文|拼音|首拼"},toLowerCase:{value:!0},more:{value:"更多选项请搜索"},showMax:{value:15},objList:{value:[]},rememberable:{value:!0},listParam:{value:"name"},itemTemplate:{value:'<li class="{className}"><span>{text}</span></li>'},listTemplate:{value:'<div class="{cssCompleteList}"><p class="{cssTip}">{msg}</p><ul class="{cssList}"></ul><p class="{cssMore}">{more}</p><ul class="{cssMenuOperator}"></ul></div>'},highlightFirstMatch:{value:!1},searchKey:{value:""},matchMode:{value:"start"},showCheckbox:{value:!1},fillTarget:{value:!0},menuItem:{value:null},callback:{value:null},width:{value:142},url:{value:""},noDataTips:{value:"无数据"},polling:{value:[]},node:{value:null,setter:"_setNode"},cascade:{value:null},dataUrl:{value:null},action:{value:null},queryNode:{value:null},ayncsearch:{value:!1},placeholder:{value:""},defaultItem:{value:{name:"无",id:"0"}},forbidWrite:{value:!0},searchInterval:{value:500},zIndex:{value:100},maxShowItemCount:{value:0}}});e.mt.widget.AutoCompleteList=h},"1.0.0",{requires:["mt-base","mt-pinyin","mt-io","w-core","base-build","widget","widget-position","widget-position-align","widget-stack","p-node-placeholder","w-autocomplete/p-cascade","w-autocomplete/p-asyncsearch","node","io","event-valuechange"],skinnable:!0});
M.add("w-autocomplete/p-cascade",function(e){e.namespace("mt.plugin.autocomplete");var t=(e.Lang.trim,e.mt.macro,e.Lang.isArray),n=e.Base.create("autocomplete-cascade",e.Plugin.Base,[],{initializer:function(){var t=e.mt.widget.AutoCompleteList;this.get("host").insIndex=0,this.autoIns=[this.get("host")],this._initIns(),this.doAfter(t.EVENT_NAME.select,this.cascadeNextIns)},_initIns:function(){var n,i,a=this.get("nds"),o=e.mt.widget.AutoCompleteList,r=this.get("host"),s=(r.getValue(),this);a&&t(a)&&e.Array.each(a,function(t,a){0!==a&&(n=s.getUpdataParams(t,a),e.Global.fire("AutoCompleteList:beforeInitIns",{params:n,index:a,nd:t}),i=new o(n),i.on(o.EVENT_NAME.select,s.cascadeNextIns,s),i.insIndex=a,s.autoIns.push(i),e.Global.fire("AutoCompleteList:afterInitIns",{ins:s.autoIns,index:a,nd:t}))})},_getQueryString:function(e){for(var t,n=null,i=[],a=0;e>a;a++)n=this.autoIns[a],t=n.getValue(),i.push(t.hiddenInput.getAttribute("name")+"="+t.id);return i.join("&")},getObjList:function(e){var n,i=this.get("host"),a=this.autoIns[e-1],o=a.getValue();if(!o)return{};if(n=a.get("objList"),!t(n))return{};for(var r=0;r<n.length;r++){var s=n[r];if(s[i.get("listParam")].toString()===o.name.toString()&&s.hasOwnProperty("id")&&s.id.toString()===o.id.toString())return n[r].cascade||{}}return{}},getUpdataParams:function(e,t){var n={node:e},i=this.get("actions"),a=this.autoIns[t];i&&i[t]?(n.dataUrl=i[t]+"?"+this._getQueryString(t),n.action=n.dataUrl):(n.objList=this.getObjList(t),n.data=n.objList,a&&a.set("objList",n.objList));var o=this.get("callback");return o&&(n.callback=o[t]),n},cascadeNextIns:function(e){for(var t=e.ins,n=t.insIndex,i=(this.get("host"),null),a=n+1;a<this.autoIns.length;a++)i=this.autoIns[a],i.updateData(this.getUpdataParams(null,a),this.get("keepOldValue")),this.get("selectFirstItem")===!0&&this.selectFirstItem(i)},selectFirstItem:function(e){var t=this.getFirstObj(e.get("objList"));e.setValue(t)},getFirstObj:function(e){for(var t in e)if(e.hasOwnProperty(t))return e[t];return{}}},{NS:"plugin-autocomplete-cascade",ATTRS:{nds:{value:null},actions:{value:null},callback:{value:[]},selectFirstItem:{value:!1},keepOldValue:{value:!0}}});e.mt.plugin.autocomplete.Cascade=n},"1.0.0",{requires:["mt-base","base-build","plugin","w-autocomplete"]});
M.add("crm-city",function(e){e.namespace("mt"),e.mt.City={_listData:null,_mapData:null,_dataUrl:"/crmopen/city/list/jsonp?callback={callback}",init:function(e){var t=this;null==t._listData?t._initData(e):e&&e(t._listData)},getCity:function(t,n,i,a,o){function s(){e.io(a,{method:"get",on:{success:function(a,s){var r=e.JSON.parse(s.responseText);l.buildCityAuto({data:r,param:o,container:t,successCallback:n,chooseCallback:i})},failure:function(){}}})}var r,l=this;a=a||"/account/getMyCitys",r?this.buildCityAuto({data:r,param:o,container:t,successCallback:n,chooseCallback:i}):s()},buildCityAuto:function(t){var n=t.data,i=t.param,a=t.successCallback,o=t.chooseCallback,s=t.container,r=s.one(".city-id"),l=s.one(".city-name"),u=s.one('input[name="districtName"]'),c=s.one('input[name="locationId"]'),d=s.one('input[name="bizAreaName"]'),h=s.one('input[name="bareaId"]');(n&&1==n.length||""==l.get("value")&&""==r.get("value"))&&(i&&i.excludeAll&&"全部"==n[0].name?n&&n.length>1&&(r.set("value",n[1].id||""),l.set("value",n[1].name||"")):(r.set("value",n[0].id||""),l.set("value",n[0].name||""))),new e.mt.widget.AutoCompleteList({objList:n,listParam:"name",node:l,showMax:"10",width:98,callback:function(e){u&&c&&(u.set("value",""),c.set("value","")),d&&h&&(d.set("value",""),h.set("value","")),o&&o(e)}}),a&&a(n)},_initData:function(t){var n=this;e.jsonp(n._dataUrl,function(e){n._listData=e;for(var i={},a=0,o=e.length;o>a;a++)0==e[a].id&&(e[a].id=-1),i[e[a].id]=e[a];n._mapData=i,t&&t(e)})},getData:function(){return this._listData},getCityDesc:function(e){return this._mapData[e].name}}},"1.0.0",{requires:["crm-client-storage","jsonp","w-autocomplete","io","json"]});
M.add("crm-cascade-menu",function(e){var t=e.mt.util,n=e.mt.widget.util,i=e.Base.create("cascadeMenu",e.Widget,[e.WidgetPosition,e.WidgetPositionAlign,e.WidgetStack],{initializer:function(){var t=this;this.bBox=this.get("boundingBox"),this.set("docHeight",e.one("body").get("docHeight")),this.onceAfter("initializedChange",function(){t.render()})},updateData:function(e){this.bBox.setHTML(""),this.set("dataArr",e),this.renderUI()},renderUI:function(){var t=this,n=this.get("dataArr"),a=i.TEMPLATE.list;e.Array.each(n,function(n){var o=e.Lang.sub(i.TEMPLATE.item,n);a+=o,a+=t.traverseHTML(n.members),n.members&&n.members.length>0&&(a+="<i>></i>"),a+="</li>"}),a+="</ul>";var o=e.Node.create(a);this.bBox.appendChild(o),this.bBox.setStyle("display","none")},traverseHTML:function(t){if(!t||t.length<=0)return"";var n=i.TEMPLATE.sublist,a=this;return e.Object.each(t,function(t){var o=e.Lang.sub(i.TEMPLATE.item,t);n+=o,n+=a.traverseHTML(t.members),t.members&&(n+="<i>></i>"),n+="</li>"}),n+="</ul>"},showResultBox:function(){this.bBox.setStyles({display:"block",position:"absolute",zIndex:10});var e=this.bBox.get("region").height,t=this.get("node").get("region"),n=t.top+t.height;if(e>this.get("docHeight")-n){var i=Math.ceil(e/(this.get("docHeight")-n));this.bBox.one(".lay-screen").setStyles({width:130*i+"px",height:this.get("docHeight")-n})}this.set("align",{node:this.get("node"),points:["tl","bl"]})},bindUI:function(){var e=this.bBox,t=this;this.mouseOverEvt(),this.liClickEvt(),n.hideNodeByClickDocument(e,this.get("node"),function(){e.all(".sublevel").setStyle("display","none")}),this.get("node").on("click",function(){t.showResultBox()})},mouseOverEvt:function(){var e=this.bBox,t=this;e.delegate("mouseenter",function(n){n.halt(!0),t.mainMenuHeight||(t.mainMenuHeight=e.one(".lay-screen").getY());var i=this.one(".sublevel");if(i){i.show();var a=i.get("region");if(a.height>t.get("docHeight")){var o=Math.ceil(a.height/(this.get("docHeight")-30));i.setStyles({width:130*o+"px",top:30-a.top+"px"}),a.top+a.height-30<this.getY()&&i.setStyle("top",this.getY()-a.height+30+"px")}else a.top+a.height>t.get("docHeight")&&i.setStyles({top:t.get("docHeight")-a.height-a.top+"px",width:"130px"})}},".item")},liClickEvt:function(){var e=this.bBox,n=this;e.delegate("click",function(i){i.halt(!0);var a=t.decodeJSON(this.getAttribute("data-params")),o={id:a.id,name:a.name,isLeaf:a.isLeaf};o=n.buildTargetData(o,this.ancestor(".item")),e.setStyle("display","none"),e.all(".sublevel").setStyle("display","none"),n.get("callback")&&n.get("callback")(o)},".item")},buildTargetData:function(e,n){if(n){var i=t.decodeJSON(n.getAttribute("data-params"));e.parent={id:i.id,name:i.name},this.buildTargetData(e.parent,n.ancestor(".item"))}return e}},{CSS_PREFIX:"widget-cascade-menu",TEMPLATE:{list:'<ul class="lay-screen">',sublist:'<ul class="lay-screen sublevel">',item:"<li class=\"item\" data-params=\"{ 'nouse': '{nouse}', 'id': '{id}', 'name': '{name}', 'isLeaf': '{isLeaf}' }\" ><a href=\"javascript:void(0);\" title=\"{name}\">{name}</a>"},ATTRS:{callback:{value:null},node:{value:null},dataArr:{value:null},docHeight:{value:null}}});e.namespace("mt.crm").CascadeMenu=i},"1.0.0",{requires:["mt-base","widget","widget-position","widget-position-align","widget-stack","w-core","node","base"],skinnable:!0});
M.add("crm-businessarea",function(e){e.namespace("mt"),e.mt.BusinessArea={_listData:{},_dataUrl:"/crmopen/locationarea/list/location/jsonp?callback={callback}",_districtUrl:"/orgunit/district/list/",_businessAreaUrl:"/crmopen/locationarea/list/location/businessarea/jsonp.ajax?callback={callback}",init:function(e,t){var n=this;null==n._listData[e]?n._initData(e,t):t&&t(n._listData[e])},_initData:function(t,n){var i=this,a=i._dataUrl+"&cityId="+t;e.jsonp(a,function(e){i._listData[t]=e,n&&n(e)})},cascadeDistrict:function(t,n,i){var a="/account/getAllLocationAndBareaList.ajax?orgunitId="+t,o=this;i.url&&(a=i.url+t),e.mt.io.get(a,{},function(t){200==t.status&&(i&&1==i.showAll&&t.data.unshift({id:"",name:"全部",parentId:0}),o.districtIns?o.districtIns.updateData(t.data):o.districtIns=new e.mt.crm.CascadeMenu({node:i.node,dataArr:t.data,callback:n}))})},getDistrict:function(t,n,i){var a=this._districtUrl+t;e.mt.io.get(a,{},function(e){i&&1==i.showAll&&e.unshift({id:"",name:"全部",parentId:0}),n&&n(e)})},getBusinessArea:function(t,n,i,a){var o=this;if(null!=t){var s=o._businessAreaUrl+"&locationId="+t;a&&(s=s+"&cityId="+a),e.jsonp(s,function(e){i&&1==i.showAll&&e.unshift({id:"",name:"全部",parentId:0}),i&&1==i.unproper&&e.unshift({id:"-2",name:"无合适商圈",parentId:0}),n&&n(e)})}},getBusinessAreaForOpportunity:function(t,n,i,a){if(null!=n&&null!=t){var o="/gis/list/businessarea/jsonp?callback={callback}&locationId="+n+"&cityId="+t;e.jsonp(o,function(e){a&&1==a.showAll&&e.unshift({id:"",name:"全部",parentId:0}),a&&1==a.unproper&&e.unshift({id:"-2",name:"无合适商圈",parentId:0}),i&&i(e)})}}}},"1.0.0",{requires:["jsonp","crm-cascade-menu","mt-io"]});
M.add("mt-form",function(e){e.namespace("mt.form");var t=e.mt.util,n=e.Lang.isString,a=e.mt.lang,i=e.Lang.trim,r=e.Lang.isNumber,o=e.Lang.isArray,s=e.Lang.isObject,c=e.Object.isEmpty,l=e.mt.macro,u=encodeURIComponent,d=e.io,h={_setValue:function(e,t,n){var a=e.all(t),r=this;n=i(n),a.each(function(e){var t=e.get("type"),a=e.get("value");switch(t){case"select-one":r._setSelectValue(e,n);break;case"radio":case"checkbox":r._matchValue(a,n)&&e.set("checked","checked");break;default:e.set("value",n)}})},_getValue:function(t,n,a){var r,o=t.all(n),s=[],c=this;return o.each(function(e){var t=e.get("type");if(c._checkType(t))switch(t){case"select-one":r=e.get("value"),s.push(r);break;case"select-multiple":e.get("options").each(function(e){e.get("selected")&&(r=e.get("value")||e.get("text"),s.push(r))});break;case"radio":case"checkbox":e.get("checked")&&(r=e.get("value"),s.push(r));break;default:r=e.get("value"),void 0!==r&&s.push(r)}}),e.Array.each(s,function(e,t){e=i(e),a&&(s[t]=u(e))}),s},_field:function(e,t,n){var a,i,r;if(this._checkValue(n))return this._setValue(e,t,n);if((a=e.one(t))&&(i=a.get("type"),this._checkType(i)))switch(r=this._getValue(e,t),i){case"select-multiple":case"checkbox":return r;default:if(0===r.length)return;return 1===r.length?r[0]:r}},_matchValue:function(e,t,n){return n=n||",",o(t)||(t=t.toString().split(n)),a.inArray(e,t,!1)},_setSelectValue:function(e,t){var n=!1,a=this;return e.get("options").some(function(e){return a._matchValue(e.get("value"),t)?(e.set("selected","selected"),n=!0,!0):void 0}),n},_getFieldsByNames:function(t,a){var i=[];return a?(o(a)?e.Array.each(a,function(e){i.push('[name="'+e+'"]')}):n(a)&&i.push('[name="'+a+'"]'),t.all(i.join(","))):null},_checkValue:function(e){return"undefined"!==e&&(o(e)||n(e)||r(e))},_checkType:function(e){switch(e){case"file":case void 0:case"reset":case"button":return!1;default:return!0}}};e.mt.form={toObject:function(t,n,a,i,r,o){t=e.one(t),a!==!1&&(a=!0);var s=h._getFieldsByNames(t,n);return this._serialize(t,s,o,a,i,r).formObj},toString:function(t,n,a,i,r){t=e.one(t);var o=h._getFieldsByNames(t,n);return this._serialize(t,o,r,a,i).formStr},toJSON:function(t,n,a,i){if(t=e.one(t)){"undefined"==typeof a&&(a=!1),"undefined"==typeof i&&(i=",");var r=this._serialize(t,null,n,a).formObj,s={},c=this;return e.Object.each(r,function(e,t){i&&o(e)&&(e=e.join(i)),c._parseArr(s,t,e)}),s}},field:function(t,n,a){if(t=e.one(t)){var i='[name="'+n+'"]';return h._field(t,i,a)}},fieldBySeletor:function(t,n,a){return(t=e.one(t))?h._field(t,n,a):void 0},setOptions:function(t,n,a,i){var r=i?i.one(t):e.one(t),s=this,l=n.data;if(r){r.empty();var u=e.Node.getDOMNode(r).options;if(a&&u.add(this._buildOption("",a)),o(l)){var d=n.key||n.keyField||"keyField",h=n.value||n.valueField||"valueField";e.Array.each(l,function(e){u.add(s._buildOption(e[d],e[h]))})}else if(!c(l))for(var f in l)l.hasOwnProperty(f)&&u.add(this._buildOption(f,l[f]))}},_buildOption:function(e,t){return new Option(t,e)},getCheckedBoxesAttr:function(t,n,a){n=n||"value",t=t||"input[type=checkbox]";var i=a?e.one(a).all(t):e.all(t),r=[];return i.each(function(e){"checkbox"===e.get("type")&&e.get("checked")&&r.push(e.get(n)||e.getAttribute(n))}),r},getRadioAttr:function(t,n,a){n=n||"value",t=t||'input[type="radio"]';var r=a?e.one(a).all(t):e.all(t),o="";return r.some(function(e){return"radio"===e.get("type")&&e.get("checked")?(o=i(e.get(n))||e.getAttribute(n),!0):void 0}),o},getOptionsText:function(e,t){if(!e)return null;var n=e.all('select[name="'+t+'"]');if(0===n.size())return null;var a=[];return n.each(function(e){e.get("options").some(function(e){return e.get("selected")?(a.push(e.getHTML()||""),!0):void 0})}),1===a.length?a[0]:a},toggleCheckbox:function(t,n,a){t=e.one(t),t&&t.on("click",function(){var i=a?e.one(a).all(n):e.all(n);t.get("checked")?i.set("checked","checked"):i.set("checked",!1)})},stopEnterSubmit:function(e){e.delegate("keydown",function(e){e.keyCode===l.key.ENTER&&e.halt()},"input[type]")},multiAction:function(t,n){function a(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];t.push(a.selector)}return t.join(",")}if(t=e.one(t),t&&n&&e.Lang.isArray(n)&&0!==n.length){var i=a(n);t.delegate("click",function(){for(var e=0;e<n.length;e++){var a=n[e];if(this.test(a.selector))return t.set("action",a.action),void(a.callback&&"function"==typeof a.callback&&a.callback(t,this))}},i)}},AjaxForm:function(t,n){var a=this;if(t=e.one(t)){var r=t.get("action")||n.action,o=n.method||t.get("method")||"POST",s=n.buttonPost?e.one(n.buttonPost):t,c=n.buttonPost?"click":"submit",l=n.multiAction;if(!t.test("form"))throw new Error("请保证你所提交的对象是一个form");if(""===i(r))throw new Error("表单提交地址(action)不能为空");if(l){var u=this._getMultiTriggers(l);t.delegate("click",function(e){e.halt(),a.sendRequest2ActionByTrigger(this,n,o,t)},u)}else s.on(c,function(e){e.halt(),n.beforeAjax?n.beforeAjax()&&a.sendRequest(r,o,n,t):a.sendRequest(r,o,n,t)})}},_getMultiTriggers:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t.join(",")},sendRequest2ActionByTrigger:function(e,t,n,a){var i,r=this,o=t.beforeAjaxs,s=t.multiAction;for(var c in s)s.hasOwnProperty(c)&&e.test(c)&&(i=s[c],o&&o[c]?o[c](e)&&r.sendRequest(i,n,t,a):r.sendRequest(i,n,t,a))},sendRequest:function(n,a,i,r){d(n,{method:a,data:e.mt.util.toPostData(i.query||{}),on:{success:function(n,a){var r=t.getEvalRes(a,"权限不够或者网络有问题，请稍后重试。");r.status?i.handleSuccess&&i.handleSuccess(r):i.handleFail?i.handleFail(r):e.config.win.alert(r.msg)},failure:function(){e.config.win.alert("权限不够或者网络有问题，请稍后重试。")}},form:{id:r.get("id")}})},clear:function(t,n,i){if(t=e.one(t)){var r=["hidden","text","number","email","url","search"];t.all("input,select,textarea").each(function(e){var t=e.get("type"),o=e.get("nodeName").toLowerCase();if(a.inArray(t,r)||"textarea"===o){if(i&&e.test(i))return;e.set("value","")}else n||("checkbox"===t||"radio"===t?e.set("checked",!1):"select"===o&&e.set("selectedIndex",-1))})}},reset:function(t){t=e.one(t),t&&"form"===t.get("nodeName").toLowerCase()&&t.reset()},_nestedObject2Flat:function(t){function n(t,n,a){e.Object.each(n,function(e,n){var r=a?a+"."+n:n;i(t,e,r)})}function a(t,n,a){e.Array.each(n,function(e,n){var r=a+"["+n+"]";i(t,e,r)})}function i(e,t,i){o(t)?a(e,t,i):s(t)?n(e,t,i):e[i]=t}if(!s(t))return t;var r={};return n(r,t),r},fillForm:function(t,n){var a=e.one(t);if(!a||!n)return!1;if(!e.Object.isEmpty(n)){n=this._nestedObject2Flat(n);for(var i in n)n.hasOwnProperty(i)&&this.field(a,i,n[i])}return!0},serialize:function(t,n,a,i){return t instanceof e.Node||(t=e.one("#"+t)),this._serialize(t,null,n,a,i).formStr},_serialize:function(t,n,a,i,r,o){i!==!1&&(i=!0),void 0!==r&&e.Lang.isString(r)||(r="&");var s,c,l,u={},d=[],f={};return n=n||t.all("input, select, textarea"),n.each(function(n){if(s=n.get("name"),l='[name="'+s+'"]',(!n.get("disabled")||a)&&s){if(f[s])return;c=h._getValue(t,l,i),0!==c.length&&(o?(c=c.join(o),d.push(s+"="+c)):e.Array.each(c,function(e){d.push(s+"="+e)}),1===c.length&&(c=c[0]),u[s]=c),f[s]=!0}}),{formStr:d.join(r),formObj:u}},disableSubmit:function(t,n,a){var i={},r={"background-color":"#EEE"},o="";if(t=e.one(t),a=a||{},n||e.mix(a,r),n=n?n:"disabled",t){i.className=n,i.styles="",o=e.Node.getDOMNode(t).getAttribute("style"),"string"==typeof o?i.styles=o:i.styles=o=o?o.cssText:"",t.setData("backupStyles",i),t.setAttribute("disabled","disabled"),t.addClass(n);for(var s in a)a.hasOwnProperty(s)&&(o+=";"+s+":"+a[s]);t.removeAttribute("style"),t.setAttribute("style",o),t._node.style.cssText=o}},enableSubmit:function(t){var n=null;t=e.one(t),t&&(t.removeAttribute("disabled"),n=t.getData("backupStyles"),n&&(t.removeClass(n.className),t.removeAttribute("style"),t.setAttribute("style",n.styles),t._node.style.cssText=n.styles))},_execStr:function(e){for(var t,n=/([\w\u4e00-\u9fa5]+)(["']?)(\]?)(\[?)(["']?)/g,a=[];null!==(t=n.exec(e));)a.push(t),t[3]&&(n.lastIndex=n.lastIndex-t[3].length);return a},_parseArr:function(t,n,a){var i=t;n=n.replace(/\.([\w\u4e00-\u9fa5]+)/g,'["$1"]');var r=this._execStr(n);e.Array.each(r,function(e){var t=e[1],n=/^\s*$/;n.test(t)&&(t=0),void 0===i[t]&&(e[4]&&e[5]?i[t]={}:e[4]?i[t]=[]:i[t]=a||""),i=i[t]})}}},"1.0.0",{requires:["mt-base","io-base","node"]});
/*
YUI 3.17.2 (build 9c3c78e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("datatype-number-parse",function(e,t){var n=e.Escape.regex,r="\\s*";e.mix(e.namespace("Number"),{_buildParser:e.cached(function(e,t,i,s){var o=[],u;return e&&o.push("^"+r+n(e)+r),t&&o.push(r+n(t)+r+"$"),i&&o.push(n(i)+"(?=\\d)"),u=new RegExp("(?:"+o.join("|")+")","g"),s==="."&&(s=null),function(e){return e=e.replace(u,""),s?e.replace(s,"."):e}}),parse:function(t,n){var r;n&&typeof t=="string"&&(r=this._buildParser(n.prefix,n.suffix,n.thousandsSeparator,n.decimalSeparator),t=r(t)),typeof t=="string"&&e.Lang.trim(t)!==""&&(t=+t);if(typeof t!="number"||!isFinite(t))t=null;return t}}),e.namespace("Parsers").number=e.Number.parse,e.namespace("DataType"),e.DataType.Number=e.Number},"3.17.2",{requires:["escape"]});

/*
YUI 3.17.2 (build 9c3c78e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("datatype-number-format",function(e,t){var n=e.Lang;e.mix(e.namespace("Number"),{format:function(e,t){if(n.isNumber(e)){t=t||{};var r=e<0,i=e+"",s=t.decimalPlaces,o=t.decimalSeparator||".",u=t.thousandsSeparator,a,f,l,c;n.isNumber(s)&&s>=0&&s<=20&&(i=e.toFixed(s)),o!=="."&&(i=i.replace(".",o));if(u){a=i.lastIndexOf(o),a=a>-1?a:i.length,f=i.substring(a);for(l=0,c=a;c>0;c--)l%3===0&&c!==a&&(!r||c>1)&&(f=u+f),f=i.charAt(c-1)+f,l++;i=f}return i=t.prefix?t.prefix+i:i,i=t.suffix?i+t.suffix:i,i}return n.isValue(e)&&e.toString?e.toString():""}}),e.namespace("DataType"),e.DataType.Number=e.Number},"3.17.2");

M.add("w-select-cascade",function(e){var t=e.io,n=e.Node,i=e.Lang,a=i.isNumber,o=i.isArray,s=i.isObject,r=e.mt.util;e.namespace("mt.widget"),e.mt.widget.Cascade=function(i,u){function l(){var e=k.size(),t=k.item(e-1).get("options").item(0);return t&&t.get("value")===E?!0:!1}function c(){var e,t=k.size(),n=[];for(e=0;t>e&&!(k.item(e).get("selectedIndex")<0);++e)n.push(k.item(e).get("value"));return n}function d(){k.each(function(t,n){t.setData("index",n),t.get("id")||t.set("id",e.guid())})}function h(e){e=e||u.defaultValue,p(e)}function g(){k.each(function(e){e.on("change",function(e){m(this)})}),e.Global.on("Cascade.reset",function(e){i.get("id")===e.id&&f()}),e.Global.on("Cascade.set",function(e){i.get("id")===e.id&&p(e.setting)})}function f(){var e=u.defaultValue||D;p(e)}function p(e){for(var t=0,n=k.size();n>t;++t){if("undefined"==typeof e[t])return;m(k.item(t),e[t])}}function m(t,n){var a,o=k.size(),s=t.getData("index");if("undefined"!=typeof n&&A(t,n),o-1>s)if("dynamic"===u.type&&u.action[s+1])for(S(s+1),a=s+2;o>a;++a)T(k.item(a));else{var r=k.item(s+1),l=w(s);if(C(r,l),1===l.length)m(r,l[0][0]);else for(a=s+2;o>a;++a)T(k.item(a))}else s===o-1&&e.Global.fire("Cascade.noChildren",{id:i.get("id"),index:o});e.Global.fire("Cascade.change",{id:i.get("id"),index:s})}function v(e){var t=u.prefix[e+1]||u.prefix,n=k.item(e).get("value"),i=[];return i=o(u.data)?u.data[parseInt(n,10)]||[]:u.data[t+n]||[]}function b(e){var t,n,i,a,s,r=[],l=[],c=u.data.link;for(t=0;e>=t&&(i=k.item(t).get("value"),c=c[i],c);++t);if(o(c))r=c;else if(c)for(n in c)c.hasOwnProperty(n)&&r.push(n);for(t=0,s=r.length;s>t;++t)a=u.data.def[r[t]],l.push([r[t],a]);return l}function y(e){var t,n,i,a,o,s=[];for(o=u.data,t=0;e>=t&&(i=k.item(t).get("value"),o=o[i]&&o[i].data,o);++t);if(o){o.data&&(o=o.data);for(n in o)o.hasOwnProperty(n)&&(a=o[n].data?o[n].title:o[n],s.push([n,a]))}return s}function _(e){var t,n,i,a=[];if(i=u.data[e+1],n=k.item(e).get("value"),n===E)a=[];else for(i=i[n]||i,t=0;t<i.length;++t)a.push([i[t].value,i[t].text]);return a}function w(t,n){var i,r,l=[];if(a(t))switch(u.format){case"default":l=v(t);break;case"hierarchy":l=b(t);break;case"level":l=y(t);break;case"unique":l=_(t)}else if(n)if(o(n))for(i=0;i<n.length;++i)l.push([n[i].value,n[i].text]);else if(s(n))for(i in n)n.hasOwnProperty(i)&&l.push([i,n[i]]);return!o(l)&&s(l)&&(r=[],e.Object.each(l,function(e,t){r.push([t,e])}),l=r),l}function S(n){var i,a=k.item(n),o=x(n);M(a);t(o,{method:"GET",on:{success:function(t,n){i=r.getEvalRes(n),i.status?(a.set("disabled",!1),C(a,w(null,i.data)),e.Global.fire("Cascade.io.success",{data:i})):alert(i.msg)},failure:function(t,n){e.Global.fire("Cascade.io.failure",{data:n})}}})}function x(e){var t,n,i,a=u.action[e];for(t=0;e>t;++t)n=new RegExp("\\{"+t+"\\}"),n.test(a)&&(i=k.item(t).get("value"),a=a.replace(n,i));return a}function C(t,a,s){var r,l=a.length,c=t.getData("index");if(s=s||E,T(t),!a||o(a)&&0===a.length)return t.get("options")&&t.get("options").size()||(n.getDOMNode(t).options.add(new Option(u.noChildrenText,E)),t.set("selectedIndex",0)),e.Global.fire("Cascade.noChildren",{id:i.get("id"),index:c}),!1;for(r=0;l>r;++r)n.getDOMNode(t).options.add(new Option(a[r][1],a[r][0])),a[r][0].toString()===s.toString()&&t.set("selectedIndex",t.get("options").size()-1);return!0}function T(e){var t=e.get("options");return I&&t.shift(),t.remove(),!0}function M(e){var t=n.getDOMNode(e).options;e.set("disabled",!0),t.add(new Option("loading...",E)),e.set("selectedIndex",t.length-1)}function A(e,t){var n,i,a=e.get("options").size();for(n=0;a>n;++n)if(i=e.get("options").item(n),i.get("value").toString()===t.toString())return e.set("selectedIndex",n),!0;return e.set("selectedIndex",0),!1}if(i){var k=i.all("select");if(k.size()){var L={type:"static",noChildrenText:"无子类",prefix:"",format:"default"};e.mix(u,L);var E=u.nullValue||"-1",I=l(),D=c();i.get("id")||i.set("id",e.guid()),d(),u.defaultValue&&h(),"dynamic"===u.type&&(u.action||(u.action=[],k.each(function(e){var t=r.data(e,"action")||"";u.action.push(t)}))),g()}}}},"1.0.0",{requires:["mt-base","io-base","node"]});
M.add("p-mask",function(e){e.namespace("mt.plugin");var t=e.Base.create("mask",e.Plugin.Base,[],{initializer:function(e){this.ndDoc=this.get("host"),this.renderUI()},destructor:function(){this.close()},renderUI:function(){this.open(),this.buildContent()},buildContent:function(){var e=this.ndDoc.get("offsetWidth"),t=this.ndDoc.get("winHeight"),n=this.get("content"),i=this.ndDoc.one(".overlay-mask-content"),a=this.get("styles");if(n){i.setHTML(n);var o=i.get("offsetWidth"),r=i.get("offsetHeight"),s=(e-o)/2,u=(t-r)/2+this.ndDoc.get("docScrollY"),c=0>=u?10:u;i.setXY([s,c]),a&&i.setStyles(a)}else i.addClass("overlay-mask-hidden")},open:function(){var n={width:this.ndDoc.get("docWidth"),height:this.ndDoc.get("docHeight"),mzIndex:parseInt(this.get("zIndex"),10)-1,izIndex:parseInt(this.get("zIndex"),10)-2},i=e.Lang.sub(t.TEMPLATE.mask,n);this.ndDoc.prepend(i)},close:function(){var e=this.ndDoc.one(".plugin-mask");e&&e.remove()}},{NS:"mask",TEMPLATE:{mask:'<div class="plugin-mask"><div id="overlay-mask" class="overlay-mask" style="width:{width}px; height:{height}px; z-index:{mzIndex}; visibility:visible;"></div><div class="overlay-mask-content"></div><iframe id="overlay-iframe" class="overlay-iframe" style="width:{width}; height:{height}; z-index:{izIndex}; visibility:visible;"></iframe></div>'},ATTRS:{doc:{value:e.one(document.body)},content:{value:""},zIndex:{value:10},styles:{value:null}}});e.mt.plugin.Mask=t},"1.0.0",{requires:["mt-base","base-build","plugin","node"],skinnable:!0});
/*
YUI 3.17.2 (build 9c3c78e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("yui-throttle",function(e,t){
/*! Based on work by Simon Willison: http://gist.github.com/292562 */
;e.throttle=function(t,n){n=n?n:e.config.throttleTime||150;if(n===-1)return function(){t.apply(this,arguments)};var r=e.Lang.now();return function(){var i=e.Lang.now();i-r>n&&(r=i,t.apply(this,arguments))}}},"3.17.2",{requires:["yui-base"]});

/*
YUI 3.17.2 (build 9c3c78e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("dd-ddm-base",function(e,t){var n=function(){n.superclass.constructor.apply(this,arguments)};n.NAME="ddm",n.ATTRS={dragCursor:{value:"move"},clickPixelThresh:{value:3},clickTimeThresh:{value:1e3},throttleTime:{value:-1},dragMode:{value:"point",setter:function(e){return this._setDragMode(e),e}}},e.extend(n,e.Base,{_createPG:function(){},_active:null,_setDragMode:function(t){t===null&&(t=e.DD.DDM.get("dragMode"));switch(t){case 1:case"intersect":return 1;case 2:case"strict":return 2;case 0:case"point":return 0}return 0},CSS_PREFIX:e.ClassNameManager.getClassName("dd"),_activateTargets:function(){},_drags:[],activeDrag:!1,_regDrag:function(e){return this.getDrag(e.get("node"))?!1:(this._active||this._setupListeners(),this._drags.push(e),!0)},_unregDrag:function(t){var n=[];e.Array.each(this._drags,function(e){e!==t&&(n[n.length]=e)}),this._drags=n},_setupListeners:function(){this._createPG(),this._active=!0;var t=e.one(e.config.doc);t.on("mousemove",e.throttle(e.bind(this._docMove,this),this.get("throttleTime"))),t.on("mouseup",e.bind(this._end,this))},_start:function(){this.fire("ddm:start"),this._startDrag()},_startDrag:function(){},_endDrag:function(){},_dropMove:function(){},_end:function(){this.activeDrag&&(this._shimming=!1,this._endDrag(),this.fire("ddm:end"),this.activeDrag.end.call(this.activeDrag),this.activeDrag=null)},stopDrag:function(){return this.activeDrag&&this._end(),this},_shimming:!1,_docMove:function(e){this._shimming||this._move(e)},_move:function(e){this.activeDrag&&(this.activeDrag._move.call(this.activeDrag,e),this._dropMove())},cssSizestoObject:function(e){var t=e.split(" ");switch(t.length){case 1:t[1]=t[2]=t[3]=t[0];break;case 2:t[2]=t[0],t[3]=t[1];break;case 3:t[3]=t[1]}return{top:parseInt(t[0],10),right:parseInt(t[1],10),bottom:parseInt(t[2],10),left:parseInt(t[3],10)}},getDrag:function(t){var n=!1,r=e.one(t);return r instanceof e.Node&&e.Array.each(this._drags,function(e){r.compareTo(e.get("node"))&&(n=e)}),n},swapPosition:function(t,n){t=e.DD.DDM.getNode(t),n=e.DD.DDM.getNode(n);var r=t.getXY(),i=n.getXY();return t.setXY(i),n.setXY(r),t},getNode:function(t){return t instanceof e.Node?t:(t&&t.get?e.Widget&&t instanceof e.Widget?t=t.get("boundingBox"):t=t.get("node"):t=e.one(t),t)},swapNode:function(t,n){t=e.DD.DDM.getNode(t),n=e.DD.DDM.getNode(n);var r=n.get("parentNode"),i=n.get("nextSibling");return i===t?r.insertBefore(t,n):n===t.get("nextSibling")?r.insertBefore(n,t):(t.get("parentNode").replaceChild(n,t),r.insertBefore(t,i)),t}}),e.namespace("DD"),e.DD.DDM=new n},"3.17.2",{requires:["node","base","yui-throttle","classnamemanager"]});

/*
YUI 3.17.2 (build 9c3c78e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("dd-ddm",function(e,t){e.mix(e.DD.DDM,{_pg:null,_debugShim:!1,_activateTargets:function(){},_deactivateTargets:function(){},_startDrag:function(){this.activeDrag&&this.activeDrag.get("useShim")&&(this._shimming=!0,this._pg_activate(),this._activateTargets())},_endDrag:function(){this._pg_deactivate(),this._deactivateTargets()},_pg_deactivate:function(){this._pg.setStyle("display","none")},_pg_activate:function(){this._pg||this._createPG();var e=this.activeDrag.get("activeHandle"),t="auto";e&&(t=e.getStyle("cursor")),t==="auto"&&(t=this.get("dragCursor")),this._pg_size(),this._pg.setStyles({top:0,left:0,display:"block",opacity:this._debugShim?".5":"0",cursor:t})},_pg_size:function(){if(this.activeDrag){var t=e.one("body"),n=t.get("docHeight"),r=t.get("docWidth");this._pg.setStyles({height:n+"px",width:r+"px"})}},_createPG:function(){var t=e.Node.create("<div></div>"),n=e.one("body"),r;t.setStyles({top:"0",left:"0",position:"absolute",zIndex:"9999",overflow:"hidden",backgroundColor:"red",display:"none",height:"5px",width:"5px"}),t.set("id",e.stamp(t)),t.addClass(e.DD.DDM.CSS_PREFIX+"-shim"),n.prepend(t),this._pg=t,this._pg.on("mousemove",e.throttle(e.bind(this._move,this),this.get("throttleTime"))),this._pg.on("mouseup",e.bind(this._end,this)),r=e.one("win"),e.on("window:resize",e.bind(this._pg_size,this)),r.on("scroll",e.bind(this._pg_size,this))}},!0)},"3.17.2",{requires:["dd-ddm-base","event-resize"]});

/*
YUI 3.17.2 (build 9c3c78e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("dd-ddm-drop",function(e,t){e.mix(e.DD.DDM,{_noShim:!1,_activeShims:[],_hasActiveShim:function(){return this._noShim?!0:this._activeShims.length},_addActiveShim:function(e){this._activeShims.push(e)},_removeActiveShim:function(t){var n=[];e.Array.each(this._activeShims,function(e){e._yuid!==t._yuid&&n.push(e)}),this._activeShims=n},syncActiveShims:function(t){e.later(0,this,function(t){var n=t?this.targets:this._lookup();e.Array.each(n,function(e){e.sizeShim.call(e)},this)},t)},mode:0,POINT:0,INTERSECT:1,STRICT:2,useHash:!0,activeDrop:null,validDrops:[],otherDrops:{},targets:[],_addValid:function(e){return this.validDrops.push(e),this},_removeValid:function(t){var n=[];return e.Array.each(this.validDrops,function(e){e!==t&&n.push(e)}),this.validDrops=n,this},isOverTarget:function(e){if(this.activeDrag&&e){var t=this.activeDrag.mouseXY,n,r=this.activeDrag.get("dragMode"),i,s=e.shim;if(t&&this.activeDrag){i=this.activeDrag.region;if(r===this.STRICT)return this.activeDrag.get("dragNode").inRegion(e.region,!0,i);if(e&&e.shim)return r===this.INTERSECT&&this._noShim?(n=i||this.activeDrag.get("node"),e.get("node").intersect(n,e.region).inRegion):(this._noShim&&(s=e.get("node")),s.intersect({top:t[1],bottom:t[1],left:t[0],right:t[0]},e.region).inRegion)}}return!1},clearCache:function(){this.validDrops=[],this.otherDrops={},this._activeShims=[]},_activateTargets:function(){this._noShim=!0,this.clearCache(),e.Array.each(this.targets,function(e){e._activateShim([]),e.get("noShim")===!0&&(this._noShim=!1)},this),this._handleTargetOver()},getBestMatch:function(t,n){var r=null,i=0,s;return e.Object.each(t,function(e){var t=this.activeDrag.get("dragNode").intersect(e.get("node"));e.region.area=t.area,t.inRegion&&t.area>i&&(i=t.area,r=e)},this),n?(s=[],e.Object.each(t,function(e){e!==r&&s.push(e)},this),[r,s]):r},_deactivateTargets:function(){var t=[],n,r=this.activeDrag,i=this.activeDrop;r&&i&&this.otherDrops[i]?(r.get("dragMode")?(n=this.getBestMatch(this.otherDrops,!0),i=n[0],t=n[1]):(t=this.otherDrops,delete t[i]),r.get("node").removeClass(this.CSS_PREFIX+"-drag-over"),i&&(i.fire("drop:hit",{drag:r,drop:i,others:t}),r.fire("drag:drophit",{drag:r,drop:i,others:t}))):r&&r.get("dragging")&&(r.get("node").removeClass(this.CSS_PREFIX+"-drag-over"),r.fire("drag:dropmiss",{pageX:r.lastXY[0],pageY:r.lastXY[1]})),this.activeDrop=null,e.Array.each(this.targets,function(e){e._deactivateShim([])},this)},_dropMove:function(){this._hasActiveShim()?this._handleTargetOver():e.Object.each(this.otherDrops,function(e){e._handleOut.apply(e,[])})},_lookup:function(){if(!this.useHash||this._noShim)return this.validDrops;var t=[];return e.Array.each(this.validDrops,function(e){e.shim&&e.shim.inViewportRegion(!1,e.region)&&t.push(e)}),t},_handleTargetOver:function(){var t=this._lookup();e.Array.each(t,function(e){e._handleTargetOver.call(e)},this)},_regTarget:function(e){this.targets.push(e)},_unregTarget:function(t){var n=[],r;e.Array.each(this.targets,function(e){e!==t&&n.push(e)},this),this.targets=n,r=[],e.Array.each(this.validDrops,function(e){e!==t&&r.push(e)}),this.validDrops=r},getDrop:function(t){var n=!1,r=e.one(t);return r instanceof e.Node&&e.Array.each(this.targets,function(e){r.compareTo(e.get("node"))&&(n=e)}),n}},!0)},"3.17.2",{requires:["dd-ddm"]});

/*
YUI 3.17.2 (build 9c3c78e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("dd-drag",function(e,t){var n=e.DD.DDM,r="node",i="dragging",s="dragNode",o="offsetHeight",u="offsetWidth",a="drag:mouseDown",f="drag:afterMouseDown",l="drag:removeHandle",c="drag:addHandle",h="drag:removeInvalid",p="drag:addInvalid",d="drag:start",v="drag:end",m="drag:drag",g="drag:align",y=function(t){this._lazyAddAttrs=!1,y.superclass.constructor.apply(this,arguments);var r=n._regDrag(this);r||e.error("Failed to register node, already in use: "+t.node)};y.NAME="drag",y.START_EVENT="mousedown",y.ATTRS={node:{setter:function(t){if(this._canDrag(t))return t;var n=e.one(t);return n||e.error("DD.Drag: Invalid Node Given: "+t),n}},dragNode:{setter:function(t){if(this._canDrag(t))return t;var n=e.one(t);return n||e.error("DD.Drag: Invalid dragNode Given: "+t),n}},offsetNode:{value:!0},startCentered:{value:!1},clickPixelThresh:{value:n.get("clickPixelThresh")},clickTimeThresh:{value:n.get("clickTimeThresh")},lock:{value:!1,setter:function(e){return e?this.get(r).addClass(n.CSS_PREFIX+"-locked"):this.get(r).removeClass(n.CSS_PREFIX+"-locked"),e}},data:{value:!1},move:{value:!0},useShim:{value:!0},activeHandle:{value:!1},primaryButtonOnly:{value:!0},dragging:{value:!1},parent:{value:!1},target:{value:!1,setter:function(e){return this._handleTarget(e),e}},dragMode:{value:null,setter:function(e){return n._setDragMode(e)}},groups:{value:["default"],getter:function(){return this._groups?e.Object.keys(this._groups):(this._groups={},[])},setter:function(t){return this._groups=e.Array.hash(t),t}},handles:{value:null,setter:function(t){return t?(this._handles={},e.Array.each(t,function(t){var n=t;if(t instanceof e.Node||t instanceof e.NodeList)n=t._yuid;this._handles[n]=t},this)):this._handles=null,t}},bubbles:{setter:function(e){return this.addTarget(e),e}},haltDown:{value:!0}},e.extend(y,e.Base,{_canDrag:function(e){return e&&e.setXY&&e.getXY&&e.test&&e.contains?!0:!1},_bubbleTargets:e.DD.DDM,addToGroup:function(e){return this._groups[e]=!0,n._activateTargets(),this},removeFromGroup:function(e){return delete this._groups[e],n._activateTargets(),this},target:null,_handleTarget:function(t){e.DD.Drop&&(t===!1?this.target&&(n._unregTarget(this.target),this.target=null):(e.Lang.isObject(t)||(t={}),t.bubbleTargets=t.bubbleTargets||this.getTargets(),t.node=this.get(r),t.groups=t.groups||this.get("groups"),this.target=new e.DD.Drop(t)))},_groups:null,_createEvents:function(){this.publish(a,{defaultFn:this._defMouseDownFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"}),this.publish(g,{defaultFn:this._defAlignFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"}),this.publish(m,{defaultFn:this._defDragFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"}),this.publish(v,{defaultFn:this._defEndFn,preventedFn:this._prevEndFn,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"drag"});var t=[f,l,c,h,p,d,"drag:drophit","drag:dropmiss","drag:over","drag:enter","drag:exit"];e.Array.each(t,function(e){this.publish(e,{type:e,emitFacade:!0,bubbles:!0,preventable:!1,queuable:!1,prefix:"drag"})},this)},_ev_md:null,_startTime:null,_endTime:null,_handles:null,_invalids:null,_invalidsDefault:{textarea:!0,input:!0,a:!0,button:!0,select:!0},_dragThreshMet:null,_fromTimeout:null,_clickTimeout:null,deltaXY:null,startXY:null,nodeXY:null,lastXY:null,actXY:null,realXY:null,mouseXY:null,region:null,_handleMouseUp:function(){this.fire("drag:mouseup"),this._fixIEMouseUp(),n.activeDrag&&n._end()},_fixDragStart:function(e){this.validClick(e)&&e.preventDefault()},_ieSelectFix:function(){return!1},_ieSelectBack:null,_fixIEMouseDown:function(){e.UA.ie&&(this._ieSelectBack=e.config.doc.body.onselectstart,e.config.doc.body.onselectstart=this._ieSelectFix)},_fixIEMouseUp:function(){e.UA.ie&&(e.config.doc.body.onselectstart=this._ieSelectBack)},_handleMouseDownEvent:function(e){this.validClick(e)&&e.preventDefault(),this.fire(a,{ev:e})},_defMouseDownFn:function(t){var r=t.ev;this._dragThreshMet=!1,this._ev_md=r;if(this.get("primaryButtonOnly")&&r.button>1)return!1;this.validClick(r)&&(this._fixIEMouseDown(r),y.START_EVENT.indexOf("gesture")!==0&&(this.get("haltDown")?r.halt():r.preventDefault()),this._setStartPosition([r.pageX,r.pageY]),n.activeDrag=this,this._clickTimeout=e.later(this.get("clickTimeThresh"),this,this._timeoutCheck)),this.fire(f,{ev:r})},validClick:function(t){var n=!1,i=!1,s=t.target,o=null,u=null,a=null,f=!1;if(this._handles)e.Object.each(this._handles,function(t,r){t instanceof e.Node||t instanceof e.NodeList?n||(a=t,a instanceof e.Node&&(a=new e.NodeList(t._node)),a.each(function(e){e.contains(s)&&(n=!0)})):e.Lang.isString(r)&&s.test(r+", "+r+" *")&&!o&&(o=r,n=!0)});else{i=this.get(r);if(i.contains(s)||i.compareTo(s))n=!0}return n&&this._invalids&&e.Object.each(this._invalids,function(t,r){e.Lang.isString(r)&&s.test(r+", "+r+" *")&&(n=!1)}),n&&(o?(u=t.currentTarget.all(o),f=!1,u.each(function(e){(e.contains(s)||e.compareTo(s))&&!f&&(f=!0,this.set("activeHandle",e))},this)):this.set("activeHandle",this.get(r))),n},_setStartPosition:function(e){this.startXY=e,this.nodeXY=this.lastXY=this.realXY=this.get(r).getXY(),this.get("offsetNode")?this.deltaXY=[this.startXY[0]-this.nodeXY[0],this.startXY[1]-this.nodeXY[1]]:this.deltaXY=[0,0]},_timeoutCheck:function(){!this.get("lock")&&!this._dragThreshMet&&this._ev_md&&(this._fromTimeout=this._dragThreshMet=!0,this.start(),this._alignNode([this._ev_md.pageX,this._ev_md.pageY],!0))},removeHandle:function(t){var n=t;if(t instanceof e.Node||t instanceof e.NodeList)n=t._yuid;return this._handles[n]&&(delete this._handles[n],this.fire(l,{handle:t})),this},addHandle:function(t){this._handles||(this._handles={});var n=t;if(t instanceof e.Node||t instanceof e.NodeList)n=t._yuid;return this._handles[n]=t,this.fire(c,{handle:t}),this},removeInvalid:function(e){return this._invalids[e]&&(this._invalids[e]=null,delete this._invalids[e],this.fire(h,{handle:e})),this},addInvalid:function(t){return e.Lang.isString(t)&&(this._invalids[t]=!0,this.fire(p,{handle:t})),this},initializer:function(
){this.get(r).dd=this;if(!this.get(r).get("id")){var t=e.stamp(this.get(r));this.get(r).set("id",t)}this.actXY=[],this._invalids=e.clone(this._invalidsDefault,!0),this._createEvents(),this.get(s)||this.set(s,this.get(r)),this.on("initializedChange",e.bind(this._prep,this)),this.set("groups",this.get("groups"))},_prep:function(){this._dragThreshMet=!1;var t=this.get(r);t.addClass(n.CSS_PREFIX+"-draggable"),t.on(y.START_EVENT,e.bind(this._handleMouseDownEvent,this)),t.on("mouseup",e.bind(this._handleMouseUp,this)),t.on("dragstart",e.bind(this._fixDragStart,this))},_unprep:function(){var e=this.get(r);e.removeClass(n.CSS_PREFIX+"-draggable"),e.detachAll("mouseup"),e.detachAll("dragstart"),e.detachAll(y.START_EVENT),this.mouseXY=[],this.deltaXY=[0,0],this.startXY=[],this.nodeXY=[],this.lastXY=[],this.actXY=[],this.realXY=[]},start:function(){if(!this.get("lock")&&!this.get(i)){var e=this.get(r),t,a,f;this._startTime=(new Date).getTime(),n._start(),e.addClass(n.CSS_PREFIX+"-dragging"),this.fire(d,{pageX:this.nodeXY[0],pageY:this.nodeXY[1],startTime:this._startTime}),e=this.get(s),f=this.nodeXY,t=e.get(u),a=e.get(o),this.get("startCentered")&&this._setStartPosition([f[0]+t/2,f[1]+a/2]),this.region={0:f[0],1:f[1],area:0,top:f[1],right:f[0]+t,bottom:f[1]+a,left:f[0]},this.set(i,!0)}return this},end:function(){return this._endTime=(new Date).getTime(),this._clickTimeout&&this._clickTimeout.cancel(),this._dragThreshMet=this._fromTimeout=!1,!this.get("lock")&&this.get(i)&&this.fire(v,{pageX:this.lastXY[0],pageY:this.lastXY[1],startTime:this._startTime,endTime:this._endTime}),this.get(r).removeClass(n.CSS_PREFIX+"-dragging"),this.set(i,!1),this.deltaXY=[0,0],this},_defEndFn:function(){this._fixIEMouseUp(),this._ev_md=null},_prevEndFn:function(){this._fixIEMouseUp(),this.get(s).setXY(this.nodeXY),this._ev_md=null,this.region=null},_align:function(e){this.fire(g,{pageX:e[0],pageY:e[1]})},_defAlignFn:function(e){this.actXY=[e.pageX-this.deltaXY[0],e.pageY-this.deltaXY[1]]},_alignNode:function(e,t){this._align(e),t||this._moveNode()},_moveNode:function(e){var t=[],n=[],r=this.nodeXY,i=this.actXY;t[0]=i[0]-this.lastXY[0],t[1]=i[1]-this.lastXY[1],n[0]=i[0]-this.nodeXY[0],n[1]=i[1]-this.nodeXY[1],this.region={0:i[0],1:i[1],area:0,top:i[1],right:i[0]+this.get(s).get(u),bottom:i[1]+this.get(s).get(o),left:i[0]},this.fire(m,{pageX:i[0],pageY:i[1],scroll:e,info:{start:r,xy:i,delta:t,offset:n}}),this.lastXY=i},_defDragFn:function(t){if(this.get("move")){if(t.scroll&&t.scroll.node){var n=t.scroll.node.getDOMNode();n===e.config.win?n.scrollTo(t.scroll.left,t.scroll.top):(t.scroll.node.set("scrollTop",t.scroll.top),t.scroll.node.set("scrollLeft",t.scroll.left))}this.get(s).setXY([t.pageX,t.pageY]),this.realXY=[t.pageX,t.pageY]}},_move:function(e){if(this.get("lock"))return!1;this.mouseXY=[e.pageX,e.pageY];if(!this._dragThreshMet){var t=Math.abs(this.startXY[0]-e.pageX),n=Math.abs(this.startXY[1]-e.pageY);if(t>this.get("clickPixelThresh")||n>this.get("clickPixelThresh"))this._dragThreshMet=!0,this.start(),e&&e.preventDefault&&e.preventDefault(),this._alignNode([e.pageX,e.pageY])}else this._clickTimeout&&this._clickTimeout.cancel(),this._alignNode([e.pageX,e.pageY])},stopDrag:function(){return this.get(i)&&n._end(),this},destructor:function(){this._unprep(),this.target&&this.target.destroy(),n._unregDrag(this)}}),e.namespace("DD"),e.DD.Drag=y},"3.17.2",{requires:["dd-ddm-base"]});

/*
YUI 3.17.2 (build 9c3c78e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("dd-proxy",function(e,t){var n=e.DD.DDM,r="node",i="dragNode",s="host",o=!0,u,a=function(){a.superclass.constructor.apply(this,arguments)};a.NAME="DDProxy",a.NS="proxy",a.ATTRS={host:{},moveOnEnd:{value:o},hideOnEnd:{value:o},resizeFrame:{value:o},positionProxy:{value:o},borderStyle:{value:"1px solid #808080"},cloneNode:{value:!1}},u={_hands:null,_init:function(){if(!n._proxy){n._createFrame(),e.on("domready",e.bind(this._init,this));return}this._hands||(this._hands=[]);var t,o,u=this.get(s),a=u.get(i);a.compareTo(u.get(r))&&n._proxy&&u.set(i,n._proxy),e.Array.each(this._hands,function(e){e.detach()}),t=n.on("ddm:start",e.bind(function(){n.activeDrag===u&&n._setFrame(u)},this)),o=n.on("ddm:end",e.bind(function(){u.get("dragging")&&(this.get("moveOnEnd")&&u.get(r).setXY(u.lastXY),this.get("hideOnEnd")&&u.get(i).setStyle("display","none"),this.get("cloneNode")&&(u.get(i).remove(),u.set(i,n._proxy)))},this)),this._hands=[t,o]},initializer:function(){this._init()},destructor:function(){var t=this.get(s);e.Array.each(this._hands,function(e){e.detach()}),t.set(i,t.get(r))},clone:function(){var t=this.get(s),n=t.get(r),o=n.cloneNode(!0);return o.all('input[type="radio"]').removeAttribute("name"),delete o._yuid,o.setAttribute("id",e.guid()),o.setStyle("position","absolute"),n.get("parentNode").appendChild(o),t.set(i,o),o}},e.namespace("Plugin"),e.extend(a,e.Base,u),e.Plugin.DDProxy=a,e.mix(n,{_createFrame:function(){if(!n._proxy){n._proxy=o;var t=e.Node.create("<div></div>"),r=e.one("body");t.setStyles({position:"absolute",display:"none",zIndex:"999",top:"-999px",left:"-999px"}),r.prepend(t),t.set("id",e.guid()),t.addClass(n.CSS_PREFIX+"-proxy"),n._proxy=t}},_setFrame:function(e){var t=e.get(r),s=e.get(i),o,u="auto";o=n.activeDrag.get("activeHandle"),o&&(u=o.getStyle("cursor")),u==="auto"&&(u=n.get("dragCursor")),s.setStyles({visibility:"hidden",display:"block",cursor:u,border:e.proxy.get("borderStyle")}),e.proxy.get("cloneNode")&&(s=e.proxy.clone()),e.proxy.get("resizeFrame")&&s.setStyles({height:t.get("offsetHeight")+"px",width:t.get("offsetWidth")+"px"}),e.proxy.get("positionProxy")&&s.setXY(e.nodeXY),s.setStyle("visibility","visible")}})},"3.17.2",{requires:["dd-drag"]});
